<md-expansion-panel>
    <md-expansion-panel-header>
        <md-panel-title>
            Plugin: Excel Processor
        </md-panel-title>
        <md-panel-description>
        </md-panel-description>
    </md-expansion-panel-header>
    <div fxLayout="column" fxLayoutAlign="space-between center" >
        <br/>
        <div fxFlex="49">
            <div fxLayout="row"
                fxLayoutAlign="space-between center"
                class="excel-row">
                <label
                    class="excel-label"
                    fxFlex>
                    <span
                        *ngIf="selectedSampleList.length > 0">
                        Export: <b>{{selectedSampleList.length}}</b> Sample
                    </span>
                </label>
                <button
                    md-button
                    (click)="exportSample(true)">
                    TEMPLATE
                </button>
                <button
                    md-button
                    (click)="exportSample()">
                    EXPORT
                </button>
            </div>
            <br/>
        </div>
        <br/>
        <div fxFlex="49">
            <input
                [hidden]="true"
                id="upload-file-input"
                #excelUploader
                type="file"
                name="excelFile"
                (click)="clearExcel()"
                (change)="submitExcel($event)"/>

            <div fxLayout="row"
                fxLayoutAlign="space-between center"
                class="excel-row">
                <label
                    for="upload-file-input"
                    class="excel-label"
                    fxFlex>
                    Choose File:
                    <b>
                        {{excelUploader.value.split('\\').pop()}}
                    </b>
                </label>
                <button
                    md-button
                    (click)="updateExcel()">
                    IMPORT
                </button>
            </div>
            <br/>
        </div>
    </div>
    <div
        *ngIf="excelResultSample.length > 0">
        <table
            class="excel-table">
            <thead>
                <tr>
                    <th *ngFor="let key of (excelResultSample[0] | objectKeys)">
                        {{key}}
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr
                    *ngFor="let sample of excelResultSample">
                    <td *ngFor="let key of (sample | objectKeys)">
                        {{sample[key]}}
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
    <div
        *ngIf="excelResultGroup.length > 0">
        <table
            class="excel-table">
            <thead>
                <tr>
                    <th *ngFor="let key of (excelResultGroup[0] | objectKeys)">
                        {{key}}
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr
                    *ngFor="let group of excelResultGroup">
                    <td *ngFor="let key of (group | objectKeys)">
                        {{group[key]}}
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</md-expansion-panel>
